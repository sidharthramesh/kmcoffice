{% extends "attendance/base.html" %}
{% load static %}
{% block body %}

<div id="viewport">
        <div class="show">
          <h1>Attendance Claims</h1>
          <p>Fill out the form below to claim attendance for events you've had to cover.</p>
        </div>
        <form action="" style="display:None">
            {% csrf_token %}
            {{studentform.event}}
        </form>

        <div id="name" class="show">
          <div class="tooltip">What's your name?</div>
          <input id="name_text" type="text"/>
          <div id="name_validation" class="validation"></div>
        </div>
        <div id="email">
          <div class="tooltip">Enter your email address.</div>
          <input id="email_email" type="email"/>
          <div id="email_validation" class="validation"></div>
        </div>
        <div id="rollnumber">
          <div class="tooltip">What's your roll number?</div>
          <input id="rollnumber_number" type="number"/>
          <div id="rollnumber_validation" class="validation"></div>
        </div>
        <div id="serialNumber">
          <div class="tooltip">What's your Serial number?</div>
          <input id="serialNumber_number" type="number"/>
          <div id="serialNumber_validation" class="validation"></div>
        </div>
        <div id="batch">
          <div class="tooltip">Which year and batch are you in?</div>
          <div id="batch_batches"></div>
        </div>
        <div id="classes">
          <div class="tooltip">Select the classes you've missed.</div>
          <div id="classes_calendar">
            <table>
              <thead>
                <tr>
                  <th colspan="1" id="classes_calendar_prev" style="cursor:pointer;"><</th>
                  <th colspan="5" id="classes_calendar_month">MONTH</th>
                  <th colspan="1" id="classes_calendar_next" style="cursor:pointer;">></th>
                </tr>
                <tr>
                  <th>Mon</th>
                  <th>Tue</th>
                  <th>Wed</th>
                  <th>Thu</th>
                  <th>Fri</th>
                  <th>Sat</th>
                  <th>Sun</th>
                </tr>
              </thead>
              <tbody id="classes_calendar_dates"></tbody>
            </table>
          </div>
          <div id="classes_datedList"><div class="tooltip" style="text-align:center;">Select the Batch and Date to Load Classes Then.</div></div>
          <div id="classes_otherClasses" class="noshow">
            <div>
              <h2>Other</h2>
              <div><span id="classes_otherClasses_date"></span></div>
              <div class="tooltip">What's the class?</div>
              <input type="text" id="classes_otherClasses_name"/>
              <div id="classes_otherClasses_time">
                <input type="time" id="classes_otherClasses_startTime"/> to <input type="time" id="classes_otherClasses_endTime"/>
              </div>
              <div>
                <input id="classes_otherClasses_depts" type="hidden"/>
              </div>
              <div id="classes_otherClasses_validation" class="validation"></div>
            </div>
            <div>
              <img id="classes_otherClasses_submit" src="{%static 'checkbox-unchecked.png' %}"/>
            </div>
          </div>
          <div id="classes_selection">
            <div class="tooltip">Selected Classes</div>
            <div id="classes_selection_selection"></div>
          </div>
          <div id="classes_validation" class="validation"></div>
        </div>
        <div id="events">
          <div class="tooltip">Which event did you miss these classes for?</div>
          <input type="hidden" id="events_value"/>
        </div>
        <div id="thankyou">
          <div>
            You will receive an email confirming that we have received your claims. You can recheck what you have sent.<br> Peace âœŒ
            <span id="download" style="display: none;">If you want to download this as an Excel file, click <a id="download_link" href="">here</a></span>
          </div>
        </div>
        <div id="buttonTray" class="show">
          <div id="buttonTray_next">Next</div>
        </div>
      </div>

      <script>
const departments = (function () {
  var depts = `{{periodform.department}}`;
  depts = depts.replace(/\s/g, "").split(/\<optionvalue\=\"(\d+)\"\>(\w+)\<\/option\>/g).filter((ele) => {if (ele !== "" && ele.indexOf("select") === -1) return ele;});
  var obj = {};
  for (var i = 0; i < depts.length; i += 2) {
    obj[depts[i]] = depts[i+1];
  }
  return obj;
})();
const batches = (function () {
  var bts = `{{periodform.batch}}`;
  bts = bts.replace(/\s/g, "").split(/\<optionvalue\=\"(\d+)\"\>([\w\d]+)\<\/option\>/g).filter((ele) => {if (ele !== "" && ele.indexOf("select") === -1) return ele;});
  var obj = {};
  for (var i = 0; i < bts.length; i += 2) {
    obj[bts[i]] = bts[i+1];
  }
  return obj;
})();
const events = (function () {
  var evts = `{{studentform.event}}`;
  evts = evts.replace(/\s/g, "").split(/\<optionvalue\=\"(\d+)\"\>([\w\d]+)\<\/option\>/g).filter((ele) => {if (ele !== "" && ele.indexOf("select") === -1) return ele;});
  var obj = {};
  for (var i = 0; i < evts.length; i += 2) {
    obj[evts[i]] = evts[i+1];
  }
  return obj;
})();
      </script>
{% endblock body %}
